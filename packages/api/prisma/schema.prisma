// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

enum GenerationStatus {
    PENDING
    COMPLETED
    FAILED
}

enum SubscriptionStatus {
    INACTIVE
    ACTIVE
}

enum Category {
    CORE
    BACK
    ARMS
    CHEST
    SHOULDERS
    LEGS
}

enum Subcategory {
    // Core
    UPPER_ABS
    LOWER_ABS
    SIDE_ABS
    ABDOMINALS

    // Back
    UPPER_BACK
    MIDDLE_BACK
    LOWER_BACK

    // Arms
    BICEPS
    TRICEPS
    WRIST_EXTENSORS
    WRIST_FLEXORS

    // Chest
    CHEST

    // Shoulders
    REAR_SHOULDER
    FRONT_SHOULDER
    SIDE_SHOULDER

    // Legs
    QUADRICEPS
    HAMSTRINGS
    CALVES
    GLUTES
    INNER_THIGHS
    OUTER_THIGHS
}

enum GenerationType {
    IMAGE_BASED
    EXERCISE_BASED
}

enum SplitDay {
    MONDAY
    TUESDAY
    WEDNESDAY
    THURSDAY
    FRIDAY
    SATURDAY
    SUNDAY
}

model User {
    id                 String             @unique
    name               String?
    lastName           String?
    email              String             @unique
    subscriptionStatus SubscriptionStatus @default(INACTIVE)
    createdAt          DateTime           @default(now())
    updatedAt          DateTime           @updatedAt
    Exercise           Exercise[]
    Generation         Generation[]
    Split              Split[]

    @@index([name])
}

model MusclePercentage {
    id          Int         @id @default(autoincrement())
    category    Category
    subcategory Subcategory
    percentage  String
    exercise    Exercise    @relation(fields: [exerciseId], references: [id])
    exerciseId  Int
}

model Exercise {
    id                Int                @id @default(autoincrement())
    name              String
    description       String
    category          Category
    subcategory       Subcategory
    saved             Boolean            @default(false)
    user              User               @relation(fields: [userId], references: [id])
    userId            String
    generation        Generation?        @relation(fields: [generationId], references: [id])
    generationId      Int?
    createdAt         DateTime           @default(now())
    musclePercentages MusclePercentage[]
    splits            Split[]
}

model Generation {
    id          Int              @id @default(autoincrement())
    name        String?
    description String?
    status      GenerationStatus @default(PENDING)
    image       String
    exercise    Exercise[]
    user        User             @relation(fields: [userId], references: [id])
    userId      String
    createdAt   DateTime         @default(now())
    updatedAt   DateTime         @updatedAt // New field
}

model Split {
    id        Int        @id @default(autoincrement())
    name      String
    day       SplitDay?
    exercises Exercise[]
    user      User       @relation(fields: [userId], references: [id])
    userId    String
    createdAt DateTime   @default(now())
    updatedAt DateTime   @updatedAt
}
